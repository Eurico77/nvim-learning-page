<!DOCTYPE html>
<html lang="pt-BR" class="">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guia Interativo de Atalhos Neovim</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    .active-filter {
      background-color: #52525b;
      /* zinc-600 */
      color: #ffffff;
    }

    html.dark .active-filter {
      background-color: #d4d4d8;
      /* zinc-300 */
      color: #18181b;
      /* zinc-900 */
    }

    .command-highlight {
      background-color: #fef3c7;
      /* amber-100 */
      border-radius: 3px;
      padding: 0 2px;
    }

    html.dark .command-highlight {
      background-color: #78350f;
      /* amber-900 */
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card-fade-in {
      animation: fadeIn 0.3s ease-out forwards;
    }

    .orientation-header {
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
      /* text-sm */
      font-weight: 600;
      /* font-semibold */
      color: #a1a1aa;
      /* zinc-400 */
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid #e5e7eb;
      /* stone-200 */
      padding-bottom: 0.25rem;
    }

    html.dark .orientation-header {
      color: #71717a;
      /* zinc-500 */
      border-bottom-color: #3f3f46;
      /* zinc-700 */
    }
  </style>
</head>

<body class="bg-stone-100 dark:bg-zinc-900 text-stone-800 dark:text-stone-200 transition-colors duration-300">

  <div class="container mx-auto p-4 md:p-8 max-w-5xl">
    <header class="text-center mb-8 relative">
      <h1 class="text-3xl md:text-4xl font-bold text-zinc-800 dark:text-zinc-100">Guia Interativo de Atalhos Neovim</h1>
      <p class="text-stone-600 dark:text-stone-400 mt-2">Seu documento vivo para dominar o Neovim. Filtre por modo ou
        pesquise para encontrar comandos.</p>
      <button id="theme-toggle" aria-label="Alternar tema de cores"
        class="absolute top-0 right-0 p-2 rounded-full text-stone-600 dark:text-stone-300 hover:bg-stone-200 dark:hover:bg-zinc-700 transition-colors">
        <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
        </svg>
        <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" class="w-6 h-6 hidden">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
        </svg>
      </button>
    </header>

    <div class="sticky top-0 bg-stone-100/80 dark:bg-zinc-900/80 backdrop-blur-sm py-4 z-10 mb-8">
      <div class="flex flex-col md:flex-row gap-4">
        <div class="relative flex-grow">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <svg class="w-5 h-5 text-stone-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
              stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
            </svg>
          </div>
          <input type="text" id="searchInput" placeholder="Pesquisar comando ou descrição..."
            class="w-full p-3 pl-10 pr-10 border border-stone-300 dark:border-zinc-600 rounded-lg focus:ring-2 focus:ring-zinc-500 focus:border-zinc-500 transition bg-white dark:bg-zinc-800 text-stone-800 dark:text-stone-200">
          <button id="clearSearchBtn" class="absolute inset-y-0 right-0 pr-3 flex items-center hidden"
            aria-label="Limpar busca">
            <svg class="w-5 h-5 text-stone-400 hover:text-stone-600 dark:hover:text-stone-200"
              xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <nav id="filter-nav" class="flex flex-wrap gap-2 justify-center">
          <button data-mode="all"
            class="filter-btn py-2 px-4 rounded-lg font-semibold transition-colors duration-200 bg-white dark:bg-zinc-800 shadow-sm hover:bg-stone-200 dark:hover:bg-zinc-700 active-filter">Todos</button>
          <button data-mode="normal"
            class="filter-btn py-2 px-4 rounded-lg font-semibold transition-colors duration-200 bg-white dark:bg-zinc-800 shadow-sm hover:bg-stone-200 dark:hover:bg-zinc-700">Normal</button>
          <button data-mode="insert"
            class="filter-btn py-2 px-4 rounded-lg font-semibold transition-colors duration-200 bg-white dark:bg-zinc-800 shadow-sm hover:bg-stone-200 dark:hover:bg-zinc-700">Inserção</button>
          <button data-mode="visual"
            class="filter-btn py-2 px-4 rounded-lg font-semibold transition-colors duration-200 bg-white dark:bg-zinc-800 shadow-sm hover:bg-stone-200 dark:hover:bg-zinc-700">Visual</button>
          <button data-mode="plugins"
            class="filter-btn py-2 px-4 rounded-lg font-semibold transition-colors duration-200 bg-white dark:bg-zinc-800 shadow-sm hover:bg-stone-200 dark:hover:bg-zinc-700">Plugins</button>
        </nav>
      </div>
    </div>

    <main id="commands-container" class="space-y-6" aria-live="polite">
    </main>

    <div id="no-results" class="text-center py-12 hidden">
      <h3 class="text-xl font-semibold text-stone-700 dark:text-stone-300">Nenhum comando encontrado</h3>
      <p class="text-stone-500 dark:text-stone-400 mt-2">Tente ajustar sua busca ou o filtro de modo.</p>
    </div>

  </div>

  <script>
    const commandsData = [
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`j`, `k`', description: 'Move o cursor para baixo e para cima.', example: 'Use `j` para descer uma linha ou `10j` para descer 10 linhas. O mesmo vale para `k`.', orientation: 'vertical'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`h`, `l`', description: 'Move o cursor para esquerda e direita.', example: 'Use `l` para mover um caractere para a direita.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`w`', description: '**(word)** Avança para o início da próxima palavra.', example: 'Em `const nome = "valor"`, `w` pula de `const` para `nome` e de `nome` para `=`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`W`', description: 'Avança para o início da próxima PALAVRA (ignora pontuação).', example: 'Em `const nome = "valor"`, `W` pula de `const` direto para `"valor"`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`b`', description: '**(backward)** Volta para o início da palavra anterior.', example: 'Se você avançou com `w` e passou do ponto, `b` retorna à palavra anterior.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`B`', description: 'Volta para o início da PALAVRA anterior (ignora pontuação).', example: 'Similar ao `b`, mas tratando `nome="valor"` como uma única PALAVRA.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`e`', description: '**(end)** Move para o final da palavra atual.', example: 'Para adicionar algo no final de uma palavra, use `e` para posicionar o cursor e `a` para entrar no modo de inserção.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`E`', description: 'Move para o final da PALAVRA atual (ignora pontuação).', example: 'Útil para navegar rapidamente até o fim de expressões complexas.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`ge`', description: 'Move para o final da palavra anterior.', example: 'O oposto de `e`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`gE`', description: 'Move para o final da PALAVRA anterior (ignora pontuação).', example: 'O oposto de `E`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`0`', description: 'Move o cursor para o início da linha (coluna 0).', example: 'Use `0` para ir ao início absoluto da linha, mesmo que haja espaços ou tabulações.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`^`', description: 'Move para o primeiro caractere não branco da linha.', example: 'Em uma linha indentada, `^` leva o cursor para o início do código, ignorando a indentação.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`$`', description: 'Move o cursor para o final da linha.', example: 'Para adicionar um ponto e vírgula no final da linha, use `$` seguido de `a` e digite `;`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`g_`', description: 'Move para o último caractere não branco da linha.', example: 'Ignora espaços em branco no final da linha.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`f{char}`', description: '**(find)** Pula para a próxima ocorrência do {char} na linha.', example: 'Use `f"` para pular para as próximas aspas na linha.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`F{char}`', description: 'Pula para a ocorrência anterior do {char} na linha.', example: 'Oposto de `f`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`t{char}`', description: '**(till)** Pula para a posição ANTES da próxima ocorrência do {char}.', example: 'Use `t,` para posicionar o cursor antes da próxima vírgula.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`T{char}`', description: 'Pula para a posição DEPOIS da ocorrência anterior do {char}.', example: 'Oposto de `t`.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`;`', description: 'Repete o último comando `f`, `F`, `t` ou `T`.', example: 'Após usar `f"`, pressione `;` para ir para as próximas aspas.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`,`', description: 'Repete o último comando `f`, `F`, `t` ou `T` na direção oposta.', example: 'Se você usou `;` demais, `,` volta.', orientation: 'horizontal'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`gg`', description: '**(go)** Vai para o início do arquivo.', example: 'Precisa adicionar um `import` no topo do arquivo? Pressione `gg`.', orientation: 'vertical'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`G`', description: '**(Go)** Vai para o final do arquivo.', example: 'Para verificar o final de um arquivo de log ou adicionar algo na última linha, use `G`.', orientation: 'vertical'},
      {mode: 'normal', context: 'Movimentação (Cursor)', command: '`50G`', description: 'Vai para a linha 50.', example: 'Se um erro aponta para a linha 123, digite `123G` para pular diretamente para ela.', orientation: 'vertical'},

      // MELHORIA: Nova seção de Operadores
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`d`', description: '**(delete)** Apaga o texto coberto pelo movimento.', example: 'Use `dw` para apagar uma palavra, `d$` para apagar até o final da linha, ou `d2j` para apagar 3 linhas.'},
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`c`', description: '**(change)** Apaga o texto do movimento e entra no Modo de Inserção.', example: 'Use `cw` para mudar uma palavra, ou `c` para mudar até o final da linha.'},
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`y`', description: '**(yank)** Copia o texto coberto pelo movimento.', example: 'Use `yw` para copiar uma palavra, ou `y` para copiar até o final da linha.'},
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`g~`', description: 'Inverte o case (maiúsculas/minúsculas) do texto no movimento.', example: 'Use `g~w` para inverter o case de uma palavra, ou `g~g~` para a linha inteira.'},
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`gu`', description: 'Transforma o texto do movimento em minúsculas.', example: 'Use `guw` para transformar uma palavra em minúsculas, ou `gugu` para a linha.'},
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`gU`', description: 'Transforma o texto do movimento em maiúsculas.', example: 'Use `gUw` para transformar uma palavra em maiúsculas, ou `gUgU` para a linha.'},
      {mode: 'normal', context: 'Operadores (Ação + Movimento)', command: '`zf`', description: 'Cria uma dobra (fold) no texto coberto pelo movimento.', example: 'Selecione linhas no modo Visual e use `zf`, ou `zf3j` para criar uma dobra nas próximas 3 linhas.'},

      {mode: 'normal', context: 'Edição (Ações)', command: '`i`', description: '**(insert)** Entra no Modo de Inserção antes do cursor.', example: 'Posicione o cursor onde quer começar a digitar e pressione `i`.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`a`', description: '**(append)** Entra no Modo de Inserção depois do cursor.', example: 'Para adicionar um caractere no final de uma palavra, posicione o cursor no último caractere e pressione `a`.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`o`', description: '**(open)** Cria uma nova linha abaixo e entra em Modo de Inserção.', example: 'É a forma mais rápida de adicionar uma nova linha de código abaixo da atual.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`O`', description: 'Cria uma nova linha acima e entra em Modo de Inserção.', example: 'Útil para adicionar uma linha de comentário ou uma declaração de variável acima da linha atual.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`dd`', description: 'Deleta a linha inteira (atalho para `d` no movimento "linha").', example: 'Para remover uma linha, posicione o cursor nela e pressione `dd`. A linha será recortada (pode colar com `p`).'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`cc`', description: '**(change line)** Altera a linha inteira (atalho para `c`).', example: 'Use `cc` para reescrever uma linha inteira do zero.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`yy`', description: 'Copia a linha inteira (atalho para `y`).', example: 'Para duplicar uma linha, pressione `yy` para copiá-la e `p` para colá-la na linha de baixo.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`p`', description: '**(put)** Cola o conteúdo copiado/recortado depois do cursor.', example: 'Após usar `dd` ou `yy`, mova o cursor para o local desejado e use `p` para colar.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`x`', description: 'Deleta o caractere sob o cursor.', example: 'Equivalente a pressionar "Delete", mas sem sair do Modo Normal.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`.`', description: 'Repete o último comando de alteração.', example: 'Se você alterou uma palavra com `cw`, pode ir para outra palavra e pressionar `.` para aplicar a mesma alteração.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`u`', description: '**(undo)** Desfaz a última ação.', example: 'Deletou uma linha com `dd` por engano? Pressione `u` para trazê-la de volta.'},
      {mode: 'normal', context: 'Edição (Ações)', command: '`Ctrl + r`', description: '**(redo)** Refaz a última ação desfeita.', example: 'Se você desfez algo com `u` mas se arrependeu, `Ctrl + r` refaz a ação.'},
      {mode: 'normal', context: 'Edição com Text Objects', command: '`ciw`', description: '**(change inside word)** Altera a palavra inteira.', example: 'Para renomear `variavel`, posicione o cursor nela, digite `ciw`, o novo nome, e `Esc`.'},
      {mode: 'normal', context: 'Edição com Text Objects', command: '`cit`', description: '**(change inside tag)** Altera o conteúdo de uma tag HTML/XML.', example: 'Em `<div>Texto antigo</div>`, posicione o cursor em "Texto antigo" e digite `cit` para apagar e começar a digitar.'},
      {mode: 'normal', context: 'Edição com Text Objects', command: '`ci"`', description: '**(change inside quotes)** Altera o conteúdo dentro de aspas duplas.', example: 'Em `const nome = "valor"`, coloque o cursor em "valor" e digite `ci"` para substituir o texto.'},
      {mode: 'normal', context: 'Edição com Text Objects', command: '`ci(`', description: '**(change inside parentheses)** Altera o conteúdo dentro de parênteses.', example: 'Em `minhaFuncao(p1, p2)`, coloque o cursor entre os parênteses e digite `ci(` para editar os parâmetros.'},

      {mode: 'normal', context: 'Busca e Substituição', command: '`/texto`', description: 'Inicia uma busca para frente por "texto".', example: 'Digite `/useState` e pressione Enter para encontrar a próxima ocorrência do hook no seu componente React.'},
      {mode: 'normal', context: 'Busca e Substituição', command: '`n`', description: '**(next)** Pula para a próxima ocorrência da busca.', example: 'Após buscar por uma palavra, continue pressionando `n` para navegar por todas as ocorrências.'},
      {mode: 'normal', context: 'Busca e Substituição', command: '`*`', description: 'Busca pela palavra que está sob o cursor.', example: 'Coloque o cursor sobre o nome de uma função e pressione `*` para destacar todas as suas ocorrências no arquivo. Use `n` para pular para a próxima.'},
      {mode: 'insert', context: 'Sair do Modo', command: '`Esc` ou `Ctrl + [`', description: 'Volta para o Modo Normal.', example: 'Após terminar de digitar, pressione `Esc` para retornar ao modo de comandos e poder navegar ou executar outras ações.'},
      {mode: 'visual', context: 'Entrada no Modo', command: '`v`', description: 'Entra no Modo Visual (seleção por caractere).', example: 'Pressione `v`, use `w` ou `l` para selecionar um trecho de texto e depois `y` para copiá-lo.'},
      {mode: 'visual', context: 'Entrada no Modo', command: '`V`', description: 'Entra no Modo Visual de Linha (seleção por linhas inteiras).', example: 'Pressione `V`, depois `j` algumas vezes para selecionar várias linhas e `d` para deletá-las de uma vez.'},
      {mode: 'visual', context: 'Seleção com Text Objects', command: '`viw`', description: '**(visual inside word)** Seleciona a palavra interna atual.', example: 'Com o cursor em qualquer letra de `variavel`, `viw` selecionará apenas `variavel`.'},
      {mode: 'visual', context: 'Seleção com Text Objects', command: '`vaw`', description: '**(visual around word)** Seleciona a palavra e um espaço ao redor.', example: 'Com o cursor em `palavra` na frase `uma palavra aqui`, `vaw` selecionará `palavra ` (com o espaço).'},
      {mode: 'visual', context: 'Seleção com Text Objects', command: '`vit`', description: '**(visual inside tag)** Seleciona o conteúdo dentro de um par de tags.', example: 'Em `<h1>Título</h1>`, `vit` selecionará a palavra `Título`.'},
      {mode: 'visual', context: 'Seleção com Text Objects', command: '`vat`', description: '**(visual around tag)** Seleciona o conteúdo e as tags.', example: 'Em `<h1>Título</h1>`, `vat` selecionará toda a linha: `<h1>Título</h1>`.'},
      {mode: 'visual', context: 'Seleção com Text Objects', command: '`vi"`', description: '**(visual inside quotes)** Seleciona o texto dentro de aspas duplas.', example: 'Em `const texto = "meu texto"`, `vi"` selecionará `meu texto`.'},
      {mode: 'visual', context: 'Ações na Seleção', command: '`>`', description: 'Aumenta a indentação do bloco selecionado.', example: 'Selecione um bloco de código com `V` e `j`/`k`, depois pressione `>` para indentá-lo.'},
      {mode: 'visual', context: 'Ações na Seleção', command: '`<`', description: 'Diminui a indentação do bloco selecionado.', example: 'Se um bloco de código está indentado demais, selecione-o e pressione `<` para corrigir.'},
      {mode: 'plugins', context: 'nvim-surround', command: '`cs"\'`', description: '**(change surrounding)** Muda as aspas duplas para aspas simples.', example: 'Em um texto como `"Olá, mundo"`, coloque o cursor dentro das aspas e digite `cs"\'` para transformá-lo em `\'Olá, mundo\'`.'},
      {mode: 'plugins', context: 'nvim-surround', command: '`ysiw)`', description: '**(you surround inside word)** Envolve a palavra atual com parênteses.', example: 'Na palavra `variavel`, posicione o cursor sobre ela e digite `ysiw)` para transformá-la em `(variavel)`.'}
    ];

    const commandsContainer = document.getElementById('commands-container');
    const searchInput = document.getElementById('searchInput');
    const clearSearchBtn = document.getElementById('clearSearchBtn');
    const filterNav = document.getElementById('filter-nav');
    const noResults = document.getElementById('no-results');
    const themeToggle = document.getElementById('theme-toggle');
    const sunIcon = document.getElementById('theme-icon-sun');
    const moonIcon = document.getElementById('theme-icon-moon');

    let currentMode = 'all';
    let currentSearch = '';

    const updateThemeIcons = (isDark) => {
      if (isDark) {
        sunIcon.classList.add('hidden');
        moonIcon.classList.remove('hidden');
      } else {
        sunIcon.classList.remove('hidden');
        moonIcon.classList.add('hidden');
      }
    };

    const renderCommands = () => {
      const groupedCommands = commandsData.reduce((acc, cmd) => {
        const key = `${cmd.mode}-${cmd.context}`;
        if (!acc[key]) {
          acc[key] = {
            mode: cmd.mode,
            context: cmd.context,
            commands: []
          };
        }
        acc[key].commands.push(cmd);
        return acc;
      }, {});

      const filteredGroups = Object.values(groupedCommands).filter(group => {
        const modeMatch = currentMode === 'all' || group.mode === currentMode;
        if (!modeMatch) return false;

        if (currentSearch) {
          group.filteredCommands = group.commands.filter(cmd =>
            cmd.command.toLowerCase().includes(currentSearch) ||
            cmd.description.toLowerCase().includes(currentSearch) ||
            (cmd.example && cmd.example.toLowerCase().includes(currentSearch))
          );
          return group.filteredCommands.length > 0;
        } else {
          group.filteredCommands = group.commands;
          return true;
        }
      });

      commandsContainer.innerHTML = '';

      if (filteredGroups.length === 0) {
        noResults.classList.remove('hidden');
      } else {
        noResults.classList.add('hidden');
      }

      const modeColors = {
        normal: 'bg-sky-100 text-sky-800 dark:bg-sky-900 dark:text-sky-300',
        insert: 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300',
        visual: 'bg-violet-100 text-violet-800 dark:bg-violet-900 dark:text-violet-300',
        plugins: 'bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-300',
      };

      const generateCommandHTML = (cmd) => {
        let commandText = cmd.command.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        let descriptionText = cmd.description.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        let exampleText = cmd.example ? cmd.example.replace(/</g, '&lt;').replace(/>/g, '&gt;') : '';

        if (currentSearch) {
          const regex = new RegExp(`(${currentSearch.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
          commandText = commandText.replace(regex, `<span class="command-highlight">$1</span>`);
          descriptionText = descriptionText.replace(regex, `<span class="command-highlight">$1</span>`);
          if (exampleText) exampleText = exampleText.replace(regex, `<span class="command-highlight">$1</span>`);
        }

        const cleanCommand = cmd.command.replace(/`/g, '').replace('{char}', '');

        const exampleHTML = cmd.example ? `
          <div class="mt-3 pt-3 border-t border-stone-200 dark:border-zinc-700">
              <p class="text-sm text-stone-600 dark:text-stone-400">
                  <span class="font-semibold text-stone-700 dark:text-stone-300">Exemplo:</span> ${exampleText}
              </p>
          </div>` : '';

        return `
          <div class="py-4 border-b border-stone-200 dark:border-zinc-700 last:border-b-0">
              <div class="flex flex-col sm:flex-row sm:items-start gap-4">
                  <code class="font-mono text-sm text-zinc-700 dark:text-zinc-200 bg-zinc-100 dark:bg-zinc-700 py-1 px-2 rounded-md w-full sm:w-auto sm:min-w-[150px] shrink-0 text-center sm:text-left">${commandText}</code>
                  <p class="text-stone-700 dark:text-stone-300 text-sm flex-grow">${descriptionText}</p>
                  <button class="copy-btn group relative shrink-0" data-command="${cleanCommand}" aria-label="Copiar comando ${cleanCommand}">
                       <span class="absolute -top-8 -left-1/2 transform translate-x-1/4 w-auto min-w-max px-2 py-1 bg-zinc-600 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity">Copiar</span>
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-stone-500 dark:text-stone-400 hover:text-zinc-800 dark:hover:text-zinc-100 transition-colors">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75" />
                      </svg>
                  </button>
              </div>
              ${exampleHTML}
          </div>`;
      };

      const sortedGroups = Object.values(filteredGroups).sort((a, b) => {
        const order = ['Movimentação (Cursor)', 'Operadores (Ação + Movimento)', 'Edição (Ações)'];
        const indexA = order.indexOf(a.context);
        const indexB = order.indexOf(b.context);

        if (indexA !== -1 && indexB !== -1) return indexA - indexB;
        if (indexA !== -1) return -1;
        if (indexB !== -1) return 1;
        return a.context.localeCompare(b.context);
      });

      sortedGroups.forEach(group => {
        const card = document.createElement('div');
        card.className = 'bg-white dark:bg-zinc-800 rounded-xl shadow-lg p-6 flex flex-col transition-colors duration-300 card-fade-in hover:shadow-xl dark:hover:shadow-zinc-700/50';

        const horizontalCommands = group.filteredCommands.filter(c => c.orientation === 'horizontal');
        const verticalCommands = group.filteredCommands.filter(c => c.orientation === 'vertical');
        const otherCommands = group.filteredCommands.filter(c => !c.orientation);

        let commandsHTML = '';

        if (horizontalCommands.length > 0) {
          commandsHTML += `<h3 class="orientation-header">Na Horizontal</h3>`;
          commandsHTML += horizontalCommands.map(generateCommandHTML).join('');
        }
        if (verticalCommands.length > 0) {
          commandsHTML += `<h3 class="orientation-header">Na Vertical</h3>`;
          commandsHTML += verticalCommands.map(generateCommandHTML).join('');
        }
        if (otherCommands.length > 0) {
          if (horizontalCommands.length > 0 || verticalCommands.length > 0) {
            commandsHTML += `<h3 class="orientation-header">Outros</h3>`;
          }
          commandsHTML += otherCommands.map(generateCommandHTML).join('');
        }

        const modeName = group.mode.charAt(0).toUpperCase() + group.mode.slice(1);

        card.innerHTML = `
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold text-zinc-800 dark:text-zinc-100">${group.context}</h2>
                <span class="text-xs font-semibold px-2 py-1 rounded-full ${modeColors[group.mode] || ''}">${modeName}</span>
            </div>
            <div class="flex-grow">
                ${commandsHTML}
            </div>
        `;
        commandsContainer.appendChild(card);
      });
    };

    filterNav.addEventListener('click', (e) => {
      if (e.target.classList.contains('filter-btn')) {
        currentMode = e.target.dataset.mode;
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active-filter'));
        e.target.classList.add('active-filter');
        renderCommands();
      }
    });

    searchInput.addEventListener('input', (e) => {
      currentSearch = e.target.value.toLowerCase();
      clearSearchBtn.classList.toggle('hidden', !currentSearch);
      renderCommands();
    });

    clearSearchBtn.addEventListener('click', () => {
      searchInput.value = '';
      currentSearch = '';
      clearSearchBtn.classList.add('hidden');
      renderCommands();
      searchInput.focus();
    });

    themeToggle.addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      updateThemeIcons(isDark);
    });

    commandsContainer.addEventListener('click', (e) => {
      const copyBtn = e.target.closest('.copy-btn');
      if (copyBtn) {
        const commandToCopy = copyBtn.dataset.command;
        navigator.clipboard.writeText(commandToCopy).then(() => {
          const tooltip = copyBtn.querySelector('span');
          const originalText = tooltip.textContent;
          tooltip.textContent = 'Copiado!';
          setTimeout(() => {
            tooltip.textContent = originalText;
          }, 1500);
        }).catch(err => {
          console.error('Falha ao copiar: ', err);
        });
      }
    });

    document.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
        document.documentElement.classList.add('dark');
        updateThemeIcons(true);
      } else {
        updateThemeIcons(false);
      }
      renderCommands();
    });
  </script>
</body>

</html>
